///////////////////////////////////////////////////////////////////////////////
// File: mono_image.h
///////////////////////////////////////////////////////////////////////////////
// Purpose: Replicates mono security functionality.
///////////////////////////////////////////////////////////////////////////////
// Author: Deniz Sezen
///////////////////////////////////////////////////////////////////////////////
#pragma once

///////////////////////////////////////////////////////////////////////////////
// Includes
///////////////////////////////////////////////////////////////////////////////

// Mono includes
#include "mono_types.h"
#include "mono_glib.h"
#include "mono_image.h"
#include "mono_func_helpers.h"

///////////////////////////////////////////////////////////////////////////////
// Enumerations
///////////////////////////////////////////////////////////////////////////////

typedef enum {
    MONO_SECURITY_MODE_NONE,
    MONO_SECURITY_MODE_CORE_CLR,
    MONO_SECURITY_MODE_CAS,
    MONO_SECURITY_MODE_SMCS_HACK
} MonoSecurityMode;

///////////////////////////////////////////////////////////////////////////////
// Security interface
///////////////////////////////////////////////////////////////////////////////
DECLARE_MONO_FUNC(mono_security_set_mode, void, MonoSecurityMode);

///////////////////////////////////////////////////////////////////////////////
// Security interface initialization
///////////////////////////////////////////////////////////////////////////////
bool mono_security_api_init(void);